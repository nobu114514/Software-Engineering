{"ast":null,"code":"export default {\n  name: 'CustomerOrders',\n  data() {\n    return {\n      orders: [],\n      loading: false,\n      error: '',\n      statusFilter: '',\n      timeFilter: 'desc',\n      showDetail: false,\n      selectedOrder: null\n    };\n  },\n  created() {\n    this.fetchOrders();\n  },\n  methods: {\n    async fetchOrders() {\n      this.loading = true;\n      this.error = '';\n      try {\n        // 从localStorage获取当前登录用户名\n        const customerUsername = localStorage.getItem('customerUsername');\n\n        // 构建请求参数\n        const params = {\n          status: this.statusFilter || undefined,\n          sort: this.timeFilter\n        };\n\n        // 构建请求头\n        const headers = {\n          'X-Username': customerUsername\n        };\n\n        // 发送API请求，带上筛选参数和用户信息\n        const response = await this.$axios.get(`/orders`, {\n          params: params,\n          headers: headers\n        });\n        this.orders = response.data;\n      } catch (err) {\n        this.error = '获取订单列表失败';\n        console.error(err);\n      } finally {\n        this.loading = false;\n      }\n    },\n    showOrderDetail(order) {\n      this.selectedOrder = order;\n      this.showDetail = true;\n    },\n    closeDetail() {\n      this.showDetail = false;\n      this.selectedOrder = null;\n    },\n    formatDate(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleDateString('zh-CN');\n    },\n    formatDateTime(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleString('zh-CN');\n    },\n    formatPrice(price) {\n      if (typeof price === 'string') {\n        price = parseFloat(price);\n      }\n      return price.toFixed(2);\n    }\n  }\n};","map":{"version":3,"names":["name","data","orders","loading","error","statusFilter","timeFilter","showDetail","selectedOrder","created","fetchOrders","methods","customerUsername","localStorage","getItem","params","status","undefined","sort","headers","response","$axios","get","err","console","showOrderDetail","order","closeDetail","formatDate","dateString","date","Date","toLocaleDateString","formatDateTime","toLocaleString","formatPrice","price","parseFloat","toFixed"],"sources":["E:\\Software-Engineering2.0\\Software-Engineering-9bea62c8ef6d7754a2d932a0227f9bc4fff09a3c\\litemall\\simple-shop-frontend\\frontend\\src\\views\\CustomerOrders.vue"],"sourcesContent":["<template>\n  <div class=\"order-list\">\n    <h2>我的订单</h2>\n    \n    <!-- 筛选条件 -->\n    <div class=\"filter-section\">\n      <div class=\"filter-item\">\n        <label for=\"status-filter\">订单状态：</label>\n        <select id=\"status-filter\" v-model=\"statusFilter\" @change=\"fetchOrders\">\n          <option value=\"\">全部状态</option>\n          <option value=\"pending\">待处理</option>\n          <option value=\"completed\">已完成</option>\n        </select>\n      </div>\n      <div class=\"filter-item\">\n        <label for=\"time-filter\">时间排序：</label>\n        <select id=\"time-filter\" v-model=\"timeFilter\" @change=\"fetchOrders\">\n          <option value=\"desc\">最新优先</option>\n          <option value=\"asc\">最早优先</option>\n        </select>\n      </div>\n    </div>\n\n    <!-- 加载状态 -->\n    <div v-if=\"loading\" class=\"loading\">加载中...</div>\n\n    <!-- 错误提示 -->\n    <div v-if=\"error\" class=\"alert alert-danger\">{{ error }}</div>\n\n    <!-- 订单列表 -->\n    <div v-if=\"orders.length > 0\" class=\"orders-container\">\n      <div v-for=\"order in orders\" :key=\"order.id\" class=\"order-card card\">\n        <div class=\"order-header\">\n          <span class=\"order-id\">订单号: {{ order.id }}</span>\n          <span class=\"order-time\">{{ formatDate(order.created_at) }}</span>\n        </div>\n        \n        <div class=\"order-content\">\n          <div class=\"product-info\">\n            <span class=\"product-name\">{{ order.product_name }}</span>\n            <span class=\"order-amount\">¥{{ order.price ? formatPrice(order.price) : '0.00' }}</span>\n          </div>\n          \n          <div class=\"order-status\">\n            <span class=\"status-badge\" :class=\"order.is_completed ? 'status-completed' : 'status-pending'\">{{ order.is_completed ? '已完成' : '待处理' }}</span>\n            <button class=\"btn btn-secondary\" @click=\"showOrderDetail(order)\">查看详情</button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 无订单提示 -->\n    <div v-else-if=\"!loading\" class=\"alert alert-info\">暂无订单记录</div>\n\n    <!-- 订单详情弹窗 -->\n    <div v-if=\"showDetail\" class=\"modal-overlay\" @click.self=\"closeDetail\">\n      <div class=\"modal-content card\">\n        <div class=\"modal-header\">\n          <h3>订单详情</h3>\n          <button class=\"close-btn\" @click=\"closeDetail\">×</button>\n        </div>\n        \n        <div class=\"modal-body\" v-if=\"selectedOrder\">\n\n          <div class=\"detail-item\">\n            <label>订单编号：</label>\n            <span>{{ selectedOrder.id }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>商品名称：</label>\n            <span>{{ selectedOrder.product_name }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>订单金额：</label>\n            <span>¥{{ selectedOrder.price ? formatPrice(selectedOrder.price) : '0.00' }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>收货人：</label>\n            <span>{{ selectedOrder.buyer_name }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>联系电话：</label>\n            <span>{{ selectedOrder.phone }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>收货地址：</label>\n            <span>{{ selectedOrder.address }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>订单备注：</label>\n            <span>{{ selectedOrder.notes || '无' }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>下单时间：</label>\n            <span>{{ formatDateTime(selectedOrder.created_at) }}</span>\n          </div>\n          <div class=\"detail-item\">\n            <label>订单状态：</label>\n            <span class=\"status-badge\" :class=\"selectedOrder.is_completed ? 'status-completed' : 'status-pending'\">{{ selectedOrder.is_completed ? '已完成' : '待处理' }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'CustomerOrders',\n  data() {\n    return {\n      orders: [],\n      loading: false,\n      error: '',\n      statusFilter: '',\n      timeFilter: 'desc',\n      showDetail: false,\n      selectedOrder: null\n    }\n  },\n  created() {\n    this.fetchOrders()\n  },\n  methods: {\n    async fetchOrders() {\n      this.loading = true\n      this.error = ''\n      \n      try {\n        // 从localStorage获取当前登录用户名\n        const customerUsername = localStorage.getItem('customerUsername')\n        \n        // 构建请求参数\n        const params = {\n          status: this.statusFilter || undefined,\n          sort: this.timeFilter\n        }\n        \n        // 构建请求头\n        const headers = {\n          'X-Username': customerUsername\n        }\n        \n        // 发送API请求，带上筛选参数和用户信息\n        const response = await this.$axios.get(`/orders`, {\n          params: params,\n          headers: headers\n        })\n        \n        this.orders = response.data\n      } catch (err) {\n        this.error = '获取订单列表失败'\n        console.error(err)\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    showOrderDetail(order) {\n      this.selectedOrder = order\n      this.showDetail = true\n    },\n    \n    closeDetail() {\n      this.showDetail = false\n      this.selectedOrder = null\n    },\n    \n    formatDate(dateString) {\n      if (!dateString) return ''\n      const date = new Date(dateString)\n      return date.toLocaleDateString('zh-CN')\n    },\n    \n    formatDateTime(dateString) {\n      if (!dateString) return ''\n      const date = new Date(dateString)\n      return date.toLocaleString('zh-CN')\n    },\n    \n    formatPrice(price) {\n      if (typeof price === 'string') {\n        price = parseFloat(price)\n      }\n      return price.toFixed(2)\n    },\n    \n\n  }\n}\n</script>\n\n<style scoped>\n.order-list {\n  max-width: 1000px;\n  margin: 0 auto;\n  padding: 20px 0;\n}\n\n.filter-section {\n  display: flex;\n  gap: 20px;\n  margin-bottom: 20px;\n  padding: 15px;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n}\n\n.filter-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.filter-item label {\n  font-weight: 500;\n}\n\n.filter-item select {\n  padding: 6px 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.orders-container {\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n\n.order-card {\n  padding: 20px;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  background-color: white;\n  transition: box-shadow 0.3s;\n}\n\n.order-card:hover {\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n\n.order-header {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 15px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #eee;\n}\n\n.order-id {\n  font-weight: 600;\n  color: #333;\n}\n\n.order-time {\n  color: #666;\n  font-size: 14px;\n}\n\n.order-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.product-info {\n  flex: 1;\n}\n\n.product-name {\n  font-weight: 500;\n  color: #333;\n  margin-right: 15px;\n}\n\n.order-amount {\n  font-weight: 600;\n  color: #E02E24;\n  font-size: 18px;\n}\n\n.order-status {\n  display: flex;\n  align-items: center;\n  gap: 15px;\n}\n\n.status-badge {\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.status-pending {\n  background-color: #fff3cd;\n  color: #856404;\n}\n\n.status-completed {\n  background-color: #d4edda;\n  color: #155724;\n}\n\n.status-cancelled {\n  background-color: #f8d7da;\n  color: #721c24;\n}\n\n.loading {\n  text-align: center;\n  padding: 40px;\n  font-size: 16px;\n  color: #666;\n}\n\n/* 模态框样式 */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  max-width: 500px;\n  width: 90%;\n  max-height: 80vh;\n  overflow-y: auto;\n  background-color: white;\n  border-radius: 8px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px;\n  border-bottom: 1px solid #eee;\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: #333;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 24px;\n  cursor: pointer;\n  color: #666;\n  padding: 0;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  transition: background-color 0.2s;\n}\n\n.close-btn:hover {\n  background-color: #f5f5f5;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.detail-item {\n  display: flex;\n  margin-bottom: 15px;\n}\n\n.detail-item:last-child {\n  margin-bottom: 0;\n}\n\n.detail-item label {\n  width: 100px;\n  font-weight: 500;\n  color: #666;\n}\n\n.detail-item span {\n  flex: 1;\n  color: #333;\n}\n</style>"],"mappings":"AA2GA,eAAe;EACbA,IAAI,EAAE,gBAAgB;EACtBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,MAAM,EAAE,EAAE;MACVC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE,EAAE;MACTC,YAAY,EAAE,EAAE;MAChBC,UAAU,EAAE,MAAM;MAClBC,UAAU,EAAE,KAAK;MACjBC,aAAa,EAAE;IACjB;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,WAAW,CAAC;EACnB,CAAC;EACDC,OAAO,EAAE;IACP,MAAMD,WAAWA,CAAA,EAAG;MAClB,IAAI,CAACP,OAAM,GAAI,IAAG;MAClB,IAAI,CAACC,KAAI,GAAI,EAAC;MAEd,IAAI;QACF;QACA,MAAMQ,gBAAe,GAAIC,YAAY,CAACC,OAAO,CAAC,kBAAkB;;QAEhE;QACA,MAAMC,MAAK,GAAI;UACbC,MAAM,EAAE,IAAI,CAACX,YAAW,IAAKY,SAAS;UACtCC,IAAI,EAAE,IAAI,CAACZ;QACb;;QAEA;QACA,MAAMa,OAAM,GAAI;UACd,YAAY,EAAEP;QAChB;;QAEA;QACA,MAAMQ,QAAO,GAAI,MAAM,IAAI,CAACC,MAAM,CAACC,GAAG,CAAC,SAAS,EAAE;UAChDP,MAAM,EAAEA,MAAM;UACdI,OAAO,EAAEA;QACX,CAAC;QAED,IAAI,CAACjB,MAAK,GAAIkB,QAAQ,CAACnB,IAAG;MAC5B,EAAE,OAAOsB,GAAG,EAAE;QACZ,IAAI,CAACnB,KAAI,GAAI,UAAS;QACtBoB,OAAO,CAACpB,KAAK,CAACmB,GAAG;MACnB,UAAU;QACR,IAAI,CAACpB,OAAM,GAAI,KAAI;MACrB;IACF,CAAC;IAEDsB,eAAeA,CAACC,KAAK,EAAE;MACrB,IAAI,CAAClB,aAAY,GAAIkB,KAAI;MACzB,IAAI,CAACnB,UAAS,GAAI,IAAG;IACvB,CAAC;IAEDoB,WAAWA,CAAA,EAAG;MACZ,IAAI,CAACpB,UAAS,GAAI,KAAI;MACtB,IAAI,CAACC,aAAY,GAAI,IAAG;IAC1B,CAAC;IAEDoB,UAAUA,CAACC,UAAU,EAAE;MACrB,IAAI,CAACA,UAAU,EAAE,OAAO,EAAC;MACzB,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,UAAU;MAChC,OAAOC,IAAI,CAACE,kBAAkB,CAAC,OAAO;IACxC,CAAC;IAEDC,cAAcA,CAACJ,UAAU,EAAE;MACzB,IAAI,CAACA,UAAU,EAAE,OAAO,EAAC;MACzB,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,UAAU;MAChC,OAAOC,IAAI,CAACI,cAAc,CAAC,OAAO;IACpC,CAAC;IAEDC,WAAWA,CAACC,KAAK,EAAE;MACjB,IAAI,OAAOA,KAAI,KAAM,QAAQ,EAAE;QAC7BA,KAAI,GAAIC,UAAU,CAACD,KAAK;MAC1B;MACA,OAAOA,KAAK,CAACE,OAAO,CAAC,CAAC;IACxB;EAGF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
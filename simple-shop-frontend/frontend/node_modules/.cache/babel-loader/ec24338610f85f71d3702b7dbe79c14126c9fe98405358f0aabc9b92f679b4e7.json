{"ast":null,"code":"export default {\n  name: 'RichTextEditor',\n  props: {\n    modelValue: {\n      type: String,\n      default: ''\n    },\n    label: {\n      type: String,\n      default: ''\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  mounted() {\n    // 初始化编辑器内容\n    if (this.modelValue) {\n      this.$refs.editorRef.innerHTML = this.modelValue;\n    }\n  },\n  watch: {\n    modelValue: {\n      handler(newVal) {\n        // 确保editorRef已初始化\n        if (this.$refs.editorRef && newVal !== this.$refs.editorRef.innerHTML) {\n          // 只有当外部传入的值与编辑器当前内容不同时才更新\n          // 避免编辑器内部修改导致的循环更新\n          this.$refs.editorRef.innerHTML = newVal;\n        }\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    // 处理输入事件，直接发送内容而不重新渲染\n    onInput() {\n      const content = this.$refs.editorRef.innerHTML;\n      this.$emit('update:modelValue', content);\n    },\n    // 处理粘贴事件\n    onPaste(event) {\n      // 阻止默认粘贴行为\n      event.preventDefault();\n\n      // 获取粘贴的文本\n      const text = (event.clipboardData || window.clipboardData).getData('text/plain');\n\n      // 使用document.execCommand插入文本，保持光标位置\n      document.execCommand('insertText', false, text);\n\n      // 触发输入事件更新值\n      this.onInput();\n    },\n    // 文本格式化\n    formatText(command) {\n      try {\n        document.execCommand(command, false, null);\n        this.$refs.editorRef.focus();\n        this.onInput();\n      } catch (error) {\n        console.error('格式化文本失败:', error);\n      }\n    },\n    // 触发图片上传\n    triggerImageUpload() {\n      this.$refs.fileInput.click();\n    },\n    // 处理图片上传\n    uploadImage(event) {\n      const file = event.target.files[0];\n      if (!file) return;\n\n      // 检查文件类型\n      const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];\n      if (!validTypes.includes(file.type)) {\n        alert('请上传有效的图片文件（JPG、PNG、GIF、WebP）');\n        event.target.value = '';\n        return;\n      }\n\n      // 检查文件大小（限制为5MB）\n      if (file.size > 5 * 1024 * 1024) {\n        alert('图片大小不能超过5MB');\n        event.target.value = '';\n        return;\n      }\n      const formData = new FormData();\n      formData.append('files', file);\n\n      // 尝试获取认证token，如果有的话\n      const token = localStorage.getItem('token') || sessionStorage.getItem('token');\n\n      // 配置请求头部\n      const headers = {};\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n\n      // 扩展API路径列表，增加更多可能的后端上传接口路径\n      const apiPaths = ['/api/files/upload/images', '/files/upload/images', '/admin/upload/image', '/api/upload/image', '/upload/image', '/admin/files/upload', '/api/product/upload', '/product/upload', '/upload'];\n      let currentPathIndex = 0;\n      const maxRetries = apiPaths.length - 1;\n      const tryUpload = pathIndex => {\n        if (pathIndex >= apiPaths.length || pathIndex > maxRetries) {\n          throw new Error('所有API路径尝试均失败，请检查服务器配置');\n        }\n        const currentPath = apiPaths[pathIndex];\n        console.log(`尝试上传图片，目标URL: ${currentPath}, 尝试次数: ${pathIndex + 1}`);\n        console.log('认证token是否存在:', !!token);\n        return fetch(currentPath, {\n          method: 'POST',\n          body: formData,\n          credentials: 'include',\n          // 确保发送cookies\n          headers: headers\n        });\n      };\n\n      // 开始尝试上传，从第一个API路径开始\n      tryUpload(currentPathIndex).then(response => {\n        console.log('上传响应状态:', response.status);\n        console.log('响应内容类型:', response.headers.get('content-type'));\n\n        // 检查响应状态\n        if (!response.ok) {\n          // 如果是404错误，不立即失败，而是尝试下一个路径\n          if (response.status === 404) {\n            console.log(`路径 ${currentPath} 返回404，尝试下一个路径`);\n            if (currentPathIndex < apiPaths.length - 1) {\n              currentPathIndex++;\n              return tryUpload(currentPathIndex);\n            }\n          }\n          // 其他错误状态码则抛出错误\n          throw new Error(`请求失败，状态码: ${response.status}`);\n        }\n\n        // 先获取原始响应文本，以便在非JSON情况下查看\n        return response.text().then(text => {\n          console.log('原始响应内容:', text.substring(0, 100) + '...'); // 只显示前100个字符\n\n          // 检查是否包含HTML标签\n          if (text.includes('<!DOCTYPE') || text.includes('<html') || text.includes('<head')) {\n            console.error('检测到HTML响应，尝试下一个API路径');\n            // 如果是第一个路径失败，尝试下一个路径\n            if (currentPathIndex < apiPaths.length - 1) {\n              currentPathIndex++;\n              return tryUpload(currentPathIndex);\n            } else {\n              throw new Error('服务器返回HTML内容而非JSON');\n            }\n          }\n\n          // 尝试解析JSON\n          try {\n            return JSON.parse(text);\n          } catch (e) {\n            // 如果解析失败，尝试下一个路径\n            if (currentPathIndex < apiPaths.length - 1) {\n              currentPathIndex++;\n              return tryUpload(currentPathIndex);\n            } else {\n              // 如果所有路径都失败，创建错误对象\n              throw new Error(`非JSON响应: ${text.substring(0, 200)}...`);\n            }\n          }\n        });\n      }).then(data => {\n        console.log('上传响应数据格式:', Object.keys(data));\n        // 检查各种可能的响应格式\n        if (data && data.imageUrls && data.imageUrls.length > 0) {\n          this.insertImageAtCursor(data.imageUrls[0]);\n        } else if (data && data.url) {\n          this.insertImageAtCursor(data.url);\n        } else if (data && data.data && data.data.imageUrls && data.data.imageUrls.length > 0) {\n          this.insertImageAtCursor(data.data.imageUrls[0]);\n        } else {\n          console.error('未预期的响应格式:', data);\n          alert('上传失败: 服务器返回格式不正确');\n        }\n      }).catch(error => {\n        console.error('图片上传错误:', error);\n        // 更友好的错误提示\n        if (error.message.includes('HTML')) {\n          alert('上传失败: 服务器返回HTML内容而非JSON，可能API路径不正确或服务器未正确配置');\n        } else if (error.message.includes('Unexpected token')) {\n          alert('上传失败: 服务器返回的内容不是有效的JSON格式');\n        } else if (error.message.includes('所有API路径尝试均失败')) {\n          alert('上传失败: 无法连接到正确的图片上传API，请联系管理员');\n        } else {\n          alert('上传失败: ' + error.message);\n        }\n      }).finally(() => {\n        // 清空文件输入\n        event.target.value = '';\n      });\n    },\n    // 在光标位置插入图片\n    insertImageAtCursor(imageUrl) {\n      try {\n        const selection = window.getSelection();\n        if (!selection || selection.rangeCount === 0) {\n          // 如果没有选中区域，直接在末尾添加\n          const img = document.createElement('img');\n          img.src = imageUrl;\n          img.style.maxWidth = '100%';\n          this.$refs.editorRef.appendChild(img);\n          return;\n        }\n\n        // 获取当前选中区域\n        const range = selection.getRangeAt(0);\n\n        // 创建图片元素\n        const img = document.createElement('img');\n        img.src = imageUrl;\n        img.style.maxWidth = '100%';\n\n        // 在光标位置插入图片\n        range.deleteContents();\n        range.insertNode(img);\n\n        // 将光标移动到图片后面\n        range.setStartAfter(img);\n        range.setEndAfter(img);\n        selection.removeAllRanges();\n        selection.addRange(range);\n\n        // 更新内容并保持焦点\n        this.onInput();\n        this.$refs.editorRef.focus();\n      } catch (error) {\n        console.error('插入图片失败:', error);\n        alert('插入图片失败，请重试');\n      }\n    },\n    // 获取编辑器内容\n    getContent() {\n      return this.$refs.editorRef.innerHTML;\n    },\n    // 设置编辑器内容\n    setContent(content) {\n      this.$refs.editorRef.innerHTML = content;\n      this.$emit('update:modelValue', content);\n    },\n    // 清空编辑器\n    clear() {\n      this.$refs.editorRef.innerHTML = '';\n      this.$emit('update:modelValue', '');\n    }\n  }\n};","map":{"version":3,"names":["name","props","modelValue","type","String","default","label","disabled","Boolean","mounted","$refs","editorRef","innerHTML","watch","handler","newVal","immediate","methods","onInput","content","$emit","onPaste","event","preventDefault","text","clipboardData","window","getData","document","execCommand","formatText","command","focus","error","console","triggerImageUpload","fileInput","click","uploadImage","file","target","files","validTypes","includes","alert","value","size","formData","FormData","append","token","localStorage","getItem","sessionStorage","headers","apiPaths","currentPathIndex","maxRetries","length","tryUpload","pathIndex","Error","currentPath","log","fetch","method","body","credentials","then","response","status","get","ok","substring","JSON","parse","e","data","Object","keys","imageUrls","insertImageAtCursor","url","catch","message","finally","imageUrl","selection","getSelection","rangeCount","img","createElement","src","style","maxWidth","appendChild","range","getRangeAt","deleteContents","insertNode","setStartAfter","setEndAfter","removeAllRanges","addRange","getContent","setContent","clear"],"sources":["E:\\Software-Engineering\\litemall\\simple-shop-frontend\\frontend\\src\\components\\RichTextEditor.vue"],"sourcesContent":["<template>\n  <div class=\"editor-container\">\n    <label v-if=\"label\" class=\"editor-label\">{{ label }}</label>\n    <div ref=\"editorRef\" class=\"rich-text-editor\"\n         :contenteditable=\"!disabled\"\n         @input=\"onInput\"\n         @paste=\"onPaste\"></div>\n    <div class=\"toolbar\" v-if=\"!disabled\">\n      <button @click=\"formatText('bold')\" title=\"粗体\">粗体</button>\n      <button @click=\"formatText('italic')\" title=\"斜体\">斜体</button>\n      <button @click=\"formatText('underline')\" title=\"下划线\">下划线</button>\n      <button @click=\"triggerImageUpload\" title=\"插入图片\">插入图片</button>\n      <input ref=\"fileInput\" type=\"file\" accept=\"image/*\" style=\"display: none\" @change=\"uploadImage\">\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'RichTextEditor',\n  props: {\n    modelValue: {\n      type: String,\n      default: ''\n    },\n    label: {\n      type: String,\n      default: ''\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  mounted() {\n    // 初始化编辑器内容\n    if (this.modelValue) {\n      this.$refs.editorRef.innerHTML = this.modelValue\n    }\n  },\n  watch: {\n      modelValue: {\n        handler(newVal) {\n          // 确保editorRef已初始化\n          if (this.$refs.editorRef && newVal !== this.$refs.editorRef.innerHTML) {\n            // 只有当外部传入的值与编辑器当前内容不同时才更新\n            // 避免编辑器内部修改导致的循环更新\n            this.$refs.editorRef.innerHTML = newVal\n          }\n        },\n        immediate: true\n      }\n    },\n  methods: {\n    // 处理输入事件，直接发送内容而不重新渲染\n    onInput() {\n      const content = this.$refs.editorRef.innerHTML\n      this.$emit('update:modelValue', content)\n    },\n    \n    // 处理粘贴事件\n    onPaste(event) {\n      // 阻止默认粘贴行为\n      event.preventDefault()\n      \n      // 获取粘贴的文本\n      const text = (event.clipboardData || window.clipboardData).getData('text/plain')\n      \n      // 使用document.execCommand插入文本，保持光标位置\n      document.execCommand('insertText', false, text)\n      \n      // 触发输入事件更新值\n      this.onInput()\n    },\n    \n    // 文本格式化\n    formatText(command) {\n      try {\n        document.execCommand(command, false, null)\n        this.$refs.editorRef.focus()\n        this.onInput()\n      } catch (error) {\n        console.error('格式化文本失败:', error)\n      }\n    },\n    \n    // 触发图片上传\n    triggerImageUpload() {\n      this.$refs.fileInput.click()\n    },\n    \n    // 处理图片上传\n    uploadImage(event) {\n      const file = event.target.files[0]\n      if (!file) return\n      \n      // 检查文件类型\n      const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp']\n      if (!validTypes.includes(file.type)) {\n        alert('请上传有效的图片文件（JPG、PNG、GIF、WebP）')\n        event.target.value = ''\n        return\n      }\n      \n      // 检查文件大小（限制为5MB）\n      if (file.size > 5 * 1024 * 1024) {\n        alert('图片大小不能超过5MB')\n        event.target.value = ''\n        return\n      }\n      \n      const formData = new FormData()\n      formData.append('files', file)\n      \n      // 尝试获取认证token，如果有的话\n      const token = localStorage.getItem('token') || sessionStorage.getItem('token')\n      \n      // 配置请求头部\n      const headers = {}\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`\n      }\n      \n      // 扩展API路径列表，增加更多可能的后端上传接口路径\n      const apiPaths = [\n        '/api/files/upload/images', \n        '/files/upload/images', \n        '/admin/upload/image',\n        '/api/upload/image',\n        '/upload/image',\n        '/admin/files/upload',\n        '/api/product/upload',\n        '/product/upload',\n        '/upload'\n      ]\n      let currentPathIndex = 0\n      const maxRetries = apiPaths.length - 1\n      \n      const tryUpload = (pathIndex) => {\n        if (pathIndex >= apiPaths.length || pathIndex > maxRetries) {\n          throw new Error('所有API路径尝试均失败，请检查服务器配置')\n        }\n        \n        const currentPath = apiPaths[pathIndex]\n        console.log(`尝试上传图片，目标URL: ${currentPath}, 尝试次数: ${pathIndex + 1}`)\n        console.log('认证token是否存在:', !!token)\n        \n        return fetch(currentPath, {\n          method: 'POST',\n          body: formData,\n          credentials: 'include', // 确保发送cookies\n          headers: headers\n        })\n      }\n      \n      // 开始尝试上传，从第一个API路径开始\n      tryUpload(currentPathIndex)\n      .then(response => {\n        console.log('上传响应状态:', response.status)\n        console.log('响应内容类型:', response.headers.get('content-type'))\n        \n        // 检查响应状态\n        if (!response.ok) {\n          // 如果是404错误，不立即失败，而是尝试下一个路径\n          if (response.status === 404) {\n            console.log(`路径 ${currentPath} 返回404，尝试下一个路径`)\n            if (currentPathIndex < apiPaths.length - 1) {\n              currentPathIndex++\n              return tryUpload(currentPathIndex)\n            }\n          }\n          // 其他错误状态码则抛出错误\n          throw new Error(`请求失败，状态码: ${response.status}`)\n        }\n        \n        // 先获取原始响应文本，以便在非JSON情况下查看\n        return response.text().then(text => {\n          console.log('原始响应内容:', text.substring(0, 100) + '...') // 只显示前100个字符\n          \n          // 检查是否包含HTML标签\n          if (text.includes('<!DOCTYPE') || text.includes('<html') || text.includes('<head')) {\n            console.error('检测到HTML响应，尝试下一个API路径')\n            // 如果是第一个路径失败，尝试下一个路径\n            if (currentPathIndex < apiPaths.length - 1) {\n              currentPathIndex++\n              return tryUpload(currentPathIndex)\n            } else {\n              throw new Error('服务器返回HTML内容而非JSON')\n            }\n          }\n          \n          // 尝试解析JSON\n          try {\n            return JSON.parse(text)\n          } catch (e) {\n            // 如果解析失败，尝试下一个路径\n            if (currentPathIndex < apiPaths.length - 1) {\n              currentPathIndex++\n              return tryUpload(currentPathIndex)\n            } else {\n              // 如果所有路径都失败，创建错误对象\n              throw new Error(`非JSON响应: ${text.substring(0, 200)}...`)\n            }\n          }\n        })\n      })\n      .then(data => {\n        console.log('上传响应数据格式:', Object.keys(data))\n        // 检查各种可能的响应格式\n        if (data && data.imageUrls && data.imageUrls.length > 0) {\n          this.insertImageAtCursor(data.imageUrls[0])\n        } else if (data && data.url) {\n          this.insertImageAtCursor(data.url)\n        } else if (data && data.data && data.data.imageUrls && data.data.imageUrls.length > 0) {\n          this.insertImageAtCursor(data.data.imageUrls[0])\n        } else {\n          console.error('未预期的响应格式:', data)\n          alert('上传失败: 服务器返回格式不正确')\n        }\n      })\n      .catch(error => {\n        console.error('图片上传错误:', error)\n        // 更友好的错误提示\n        if (error.message.includes('HTML')) {\n          alert('上传失败: 服务器返回HTML内容而非JSON，可能API路径不正确或服务器未正确配置')\n        } else if (error.message.includes('Unexpected token')) {\n          alert('上传失败: 服务器返回的内容不是有效的JSON格式')\n        } else if (error.message.includes('所有API路径尝试均失败')) {\n          alert('上传失败: 无法连接到正确的图片上传API，请联系管理员')\n        } else {\n          alert('上传失败: ' + error.message)\n        }\n      })\n      .finally(() => {\n        // 清空文件输入\n        event.target.value = ''\n      })\n    },\n    \n    // 在光标位置插入图片\n    insertImageAtCursor(imageUrl) {\n      try {\n        const selection = window.getSelection()\n        if (!selection || selection.rangeCount === 0) {\n          // 如果没有选中区域，直接在末尾添加\n          const img = document.createElement('img')\n          img.src = imageUrl\n          img.style.maxWidth = '100%'\n          this.$refs.editorRef.appendChild(img)\n          return\n        }\n        \n        // 获取当前选中区域\n        const range = selection.getRangeAt(0)\n        \n        // 创建图片元素\n        const img = document.createElement('img')\n        img.src = imageUrl\n        img.style.maxWidth = '100%'\n        \n        // 在光标位置插入图片\n        range.deleteContents()\n        range.insertNode(img)\n        \n        // 将光标移动到图片后面\n        range.setStartAfter(img)\n        range.setEndAfter(img)\n        selection.removeAllRanges()\n        selection.addRange(range)\n        \n        // 更新内容并保持焦点\n        this.onInput()\n        this.$refs.editorRef.focus()\n      } catch (error) {\n        console.error('插入图片失败:', error)\n        alert('插入图片失败，请重试')\n      }\n    },\n    \n    // 获取编辑器内容\n    getContent() {\n      return this.$refs.editorRef.innerHTML\n    },\n    \n    // 设置编辑器内容\n    setContent(content) {\n      this.$refs.editorRef.innerHTML = content\n      this.$emit('update:modelValue', content)\n    },\n    \n    // 清空编辑器\n    clear() {\n      this.$refs.editorRef.innerHTML = ''\n      this.$emit('update:modelValue', '')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.editor-container {\n  margin-bottom: 20px;\n}\n\n.editor-label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #333;\n}\n\n.rich-text-editor {\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  padding: 10px;\n  min-height: 200px;\n  outline: none;\n  transition: border-color 0.3s;\n}\n\n.rich-text-editor:focus {\n  border-color: #4a90e2;\n  box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);\n}\n\n.toolbar {\n  margin-top: 8px;\n  display: flex;\n  gap: 8px;\n}\n\n.toolbar button {\n  padding: 6px 12px;\n  background-color: #f5f5f5;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n  transition: all 0.3s;\n}\n\n.toolbar button:hover {\n  background-color: #e0e0e0;\n  border-color: #bbb;\n}\n\n.toolbar button:active {\n  background-color: #d0d0d0;\n}\n\n/* 确保图片在编辑器中正确显示 */\n.rich-text-editor img {\n  max-width: 100%;\n  height: auto;\n  margin: 5px 0;\n}\n</style>"],"mappings":"AAkBA,eAAe;EACbA,IAAI,EAAE,gBAAgB;EACtBC,KAAK,EAAE;IACLC,UAAU,EAAE;MACVC,IAAI,EAAEC,MAAM;MACZC,OAAO,EAAE;IACX,CAAC;IACDC,KAAK,EAAE;MACLH,IAAI,EAAEC,MAAM;MACZC,OAAO,EAAE;IACX,CAAC;IACDE,QAAQ,EAAE;MACRJ,IAAI,EAAEK,OAAO;MACbH,OAAO,EAAE;IACX;EACF,CAAC;EACDI,OAAOA,CAAA,EAAG;IACR;IACA,IAAI,IAAI,CAACP,UAAU,EAAE;MACnB,IAAI,CAACQ,KAAK,CAACC,SAAS,CAACC,SAAQ,GAAI,IAAI,CAACV,UAAS;IACjD;EACF,CAAC;EACDW,KAAK,EAAE;IACHX,UAAU,EAAE;MACVY,OAAOA,CAACC,MAAM,EAAE;QACd;QACA,IAAI,IAAI,CAACL,KAAK,CAACC,SAAQ,IAAKI,MAAK,KAAM,IAAI,CAACL,KAAK,CAACC,SAAS,CAACC,SAAS,EAAE;UACrE;UACA;UACA,IAAI,CAACF,KAAK,CAACC,SAAS,CAACC,SAAQ,GAAIG,MAAK;QACxC;MACF,CAAC;MACDC,SAAS,EAAE;IACb;EACF,CAAC;EACHC,OAAO,EAAE;IACP;IACAC,OAAOA,CAAA,EAAG;MACR,MAAMC,OAAM,GAAI,IAAI,CAACT,KAAK,CAACC,SAAS,CAACC,SAAQ;MAC7C,IAAI,CAACQ,KAAK,CAAC,mBAAmB,EAAED,OAAO;IACzC,CAAC;IAED;IACAE,OAAOA,CAACC,KAAK,EAAE;MACb;MACAA,KAAK,CAACC,cAAc,CAAC;;MAErB;MACA,MAAMC,IAAG,GAAI,CAACF,KAAK,CAACG,aAAY,IAAKC,MAAM,CAACD,aAAa,EAAEE,OAAO,CAAC,YAAY;;MAE/E;MACAC,QAAQ,CAACC,WAAW,CAAC,YAAY,EAAE,KAAK,EAAEL,IAAI;;MAE9C;MACA,IAAI,CAACN,OAAO,CAAC;IACf,CAAC;IAED;IACAY,UAAUA,CAACC,OAAO,EAAE;MAClB,IAAI;QACFH,QAAQ,CAACC,WAAW,CAACE,OAAO,EAAE,KAAK,EAAE,IAAI;QACzC,IAAI,CAACrB,KAAK,CAACC,SAAS,CAACqB,KAAK,CAAC;QAC3B,IAAI,CAACd,OAAO,CAAC;MACf,EAAE,OAAOe,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,UAAU,EAAEA,KAAK;MACjC;IACF,CAAC;IAED;IACAE,kBAAkBA,CAAA,EAAG;MACnB,IAAI,CAACzB,KAAK,CAAC0B,SAAS,CAACC,KAAK,CAAC;IAC7B,CAAC;IAED;IACAC,WAAWA,CAAChB,KAAK,EAAE;MACjB,MAAMiB,IAAG,GAAIjB,KAAK,CAACkB,MAAM,CAACC,KAAK,CAAC,CAAC;MACjC,IAAI,CAACF,IAAI,EAAE;;MAEX;MACA,MAAMG,UAAS,GAAI,CAAC,YAAY,EAAE,WAAW,EAAE,WAAW,EAAE,YAAY;MACxE,IAAI,CAACA,UAAU,CAACC,QAAQ,CAACJ,IAAI,CAACpC,IAAI,CAAC,EAAE;QACnCyC,KAAK,CAAC,8BAA8B;QACpCtB,KAAK,CAACkB,MAAM,CAACK,KAAI,GAAI,EAAC;QACtB;MACF;;MAEA;MACA,IAAIN,IAAI,CAACO,IAAG,GAAI,IAAI,IAAG,GAAI,IAAI,EAAE;QAC/BF,KAAK,CAAC,aAAa;QACnBtB,KAAK,CAACkB,MAAM,CAACK,KAAI,GAAI,EAAC;QACtB;MACF;MAEA,MAAME,QAAO,GAAI,IAAIC,QAAQ,CAAC;MAC9BD,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEV,IAAI;;MAE7B;MACA,MAAMW,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO,KAAKC,cAAc,CAACD,OAAO,CAAC,OAAO;;MAE7E;MACA,MAAME,OAAM,GAAI,CAAC;MACjB,IAAIJ,KAAK,EAAE;QACTI,OAAO,CAAC,eAAe,IAAI,UAAUJ,KAAK,EAAC;MAC7C;;MAEA;MACA,MAAMK,QAAO,GAAI,CACf,0BAA0B,EAC1B,sBAAsB,EACtB,qBAAqB,EACrB,mBAAmB,EACnB,eAAe,EACf,qBAAqB,EACrB,qBAAqB,EACrB,iBAAiB,EACjB,SAAQ,CACV;MACA,IAAIC,gBAAe,GAAI;MACvB,MAAMC,UAAS,GAAIF,QAAQ,CAACG,MAAK,GAAI;MAErC,MAAMC,SAAQ,GAAKC,SAAS,IAAK;QAC/B,IAAIA,SAAQ,IAAKL,QAAQ,CAACG,MAAK,IAAKE,SAAQ,GAAIH,UAAU,EAAE;UAC1D,MAAM,IAAII,KAAK,CAAC,uBAAuB;QACzC;QAEA,MAAMC,WAAU,GAAIP,QAAQ,CAACK,SAAS;QACtC1B,OAAO,CAAC6B,GAAG,CAAC,iBAAiBD,WAAW,WAAWF,SAAQ,GAAI,CAAC,EAAE;QAClE1B,OAAO,CAAC6B,GAAG,CAAC,cAAc,EAAE,CAAC,CAACb,KAAK;QAEnC,OAAOc,KAAK,CAACF,WAAW,EAAE;UACxBG,MAAM,EAAE,MAAM;UACdC,IAAI,EAAEnB,QAAQ;UACdoB,WAAW,EAAE,SAAS;UAAE;UACxBb,OAAO,EAAEA;QACX,CAAC;MACH;;MAEA;MACAK,SAAS,CAACH,gBAAgB,EACzBY,IAAI,CAACC,QAAO,IAAK;QAChBnC,OAAO,CAAC6B,GAAG,CAAC,SAAS,EAAEM,QAAQ,CAACC,MAAM;QACtCpC,OAAO,CAAC6B,GAAG,CAAC,SAAS,EAAEM,QAAQ,CAACf,OAAO,CAACiB,GAAG,CAAC,cAAc,CAAC;;QAE3D;QACA,IAAI,CAACF,QAAQ,CAACG,EAAE,EAAE;UAChB;UACA,IAAIH,QAAQ,CAACC,MAAK,KAAM,GAAG,EAAE;YAC3BpC,OAAO,CAAC6B,GAAG,CAAC,MAAMD,WAAW,gBAAgB;YAC7C,IAAIN,gBAAe,GAAID,QAAQ,CAACG,MAAK,GAAI,CAAC,EAAE;cAC1CF,gBAAgB,EAAC;cACjB,OAAOG,SAAS,CAACH,gBAAgB;YACnC;UACF;UACA;UACA,MAAM,IAAIK,KAAK,CAAC,aAAaQ,QAAQ,CAACC,MAAM,EAAE;QAChD;;QAEA;QACA,OAAOD,QAAQ,CAAC7C,IAAI,CAAC,CAAC,CAAC4C,IAAI,CAAC5C,IAAG,IAAK;UAClCU,OAAO,CAAC6B,GAAG,CAAC,SAAS,EAAEvC,IAAI,CAACiD,SAAS,CAAC,CAAC,EAAE,GAAG,IAAI,KAAK,GAAE;;UAEvD;UACA,IAAIjD,IAAI,CAACmB,QAAQ,CAAC,WAAW,KAAKnB,IAAI,CAACmB,QAAQ,CAAC,OAAO,KAAKnB,IAAI,CAACmB,QAAQ,CAAC,OAAO,CAAC,EAAE;YAClFT,OAAO,CAACD,KAAK,CAAC,sBAAsB;YACpC;YACA,IAAIuB,gBAAe,GAAID,QAAQ,CAACG,MAAK,GAAI,CAAC,EAAE;cAC1CF,gBAAgB,EAAC;cACjB,OAAOG,SAAS,CAACH,gBAAgB;YACnC,OAAO;cACL,MAAM,IAAIK,KAAK,CAAC,mBAAmB;YACrC;UACF;;UAEA;UACA,IAAI;YACF,OAAOa,IAAI,CAACC,KAAK,CAACnD,IAAI;UACxB,EAAE,OAAOoD,CAAC,EAAE;YACV;YACA,IAAIpB,gBAAe,GAAID,QAAQ,CAACG,MAAK,GAAI,CAAC,EAAE;cAC1CF,gBAAgB,EAAC;cACjB,OAAOG,SAAS,CAACH,gBAAgB;YACnC,OAAO;cACL;cACA,MAAM,IAAIK,KAAK,CAAC,YAAYrC,IAAI,CAACiD,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,KAAK;YACzD;UACF;QACF,CAAC;MACH,CAAC,EACAL,IAAI,CAACS,IAAG,IAAK;QACZ3C,OAAO,CAAC6B,GAAG,CAAC,WAAW,EAAEe,MAAM,CAACC,IAAI,CAACF,IAAI,CAAC;QAC1C;QACA,IAAIA,IAAG,IAAKA,IAAI,CAACG,SAAQ,IAAKH,IAAI,CAACG,SAAS,CAACtB,MAAK,GAAI,CAAC,EAAE;UACvD,IAAI,CAACuB,mBAAmB,CAACJ,IAAI,CAACG,SAAS,CAAC,CAAC,CAAC;QAC5C,OAAO,IAAIH,IAAG,IAAKA,IAAI,CAACK,GAAG,EAAE;UAC3B,IAAI,CAACD,mBAAmB,CAACJ,IAAI,CAACK,GAAG;QACnC,OAAO,IAAIL,IAAG,IAAKA,IAAI,CAACA,IAAG,IAAKA,IAAI,CAACA,IAAI,CAACG,SAAQ,IAAKH,IAAI,CAACA,IAAI,CAACG,SAAS,CAACtB,MAAK,GAAI,CAAC,EAAE;UACrF,IAAI,CAACuB,mBAAmB,CAACJ,IAAI,CAACA,IAAI,CAACG,SAAS,CAAC,CAAC,CAAC;QACjD,OAAO;UACL9C,OAAO,CAACD,KAAK,CAAC,WAAW,EAAE4C,IAAI;UAC/BjC,KAAK,CAAC,kBAAkB;QAC1B;MACF,CAAC,EACAuC,KAAK,CAAClD,KAAI,IAAK;QACdC,OAAO,CAACD,KAAK,CAAC,SAAS,EAAEA,KAAK;QAC9B;QACA,IAAIA,KAAK,CAACmD,OAAO,CAACzC,QAAQ,CAAC,MAAM,CAAC,EAAE;UAClCC,KAAK,CAAC,6CAA6C;QACrD,OAAO,IAAIX,KAAK,CAACmD,OAAO,CAACzC,QAAQ,CAAC,kBAAkB,CAAC,EAAE;UACrDC,KAAK,CAAC,2BAA2B;QACnC,OAAO,IAAIX,KAAK,CAACmD,OAAO,CAACzC,QAAQ,CAAC,cAAc,CAAC,EAAE;UACjDC,KAAK,CAAC,8BAA8B;QACtC,OAAO;UACLA,KAAK,CAAC,QAAO,GAAIX,KAAK,CAACmD,OAAO;QAChC;MACF,CAAC,EACAC,OAAO,CAAC,MAAM;QACb;QACA/D,KAAK,CAACkB,MAAM,CAACK,KAAI,GAAI,EAAC;MACxB,CAAC;IACH,CAAC;IAED;IACAoC,mBAAmBA,CAACK,QAAQ,EAAE;MAC5B,IAAI;QACF,MAAMC,SAAQ,GAAI7D,MAAM,CAAC8D,YAAY,CAAC;QACtC,IAAI,CAACD,SAAQ,IAAKA,SAAS,CAACE,UAAS,KAAM,CAAC,EAAE;UAC5C;UACA,MAAMC,GAAE,GAAI9D,QAAQ,CAAC+D,aAAa,CAAC,KAAK;UACxCD,GAAG,CAACE,GAAE,GAAIN,QAAO;UACjBI,GAAG,CAACG,KAAK,CAACC,QAAO,GAAI,MAAK;UAC1B,IAAI,CAACpF,KAAK,CAACC,SAAS,CAACoF,WAAW,CAACL,GAAG;UACpC;QACF;;QAEA;QACA,MAAMM,KAAI,GAAIT,SAAS,CAACU,UAAU,CAAC,CAAC;;QAEpC;QACA,MAAMP,GAAE,GAAI9D,QAAQ,CAAC+D,aAAa,CAAC,KAAK;QACxCD,GAAG,CAACE,GAAE,GAAIN,QAAO;QACjBI,GAAG,CAACG,KAAK,CAACC,QAAO,GAAI,MAAK;;QAE1B;QACAE,KAAK,CAACE,cAAc,CAAC;QACrBF,KAAK,CAACG,UAAU,CAACT,GAAG;;QAEpB;QACAM,KAAK,CAACI,aAAa,CAACV,GAAG;QACvBM,KAAK,CAACK,WAAW,CAACX,GAAG;QACrBH,SAAS,CAACe,eAAe,CAAC;QAC1Bf,SAAS,CAACgB,QAAQ,CAACP,KAAK;;QAExB;QACA,IAAI,CAAC9E,OAAO,CAAC;QACb,IAAI,CAACR,KAAK,CAACC,SAAS,CAACqB,KAAK,CAAC;MAC7B,EAAE,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,SAAS,EAAEA,KAAK;QAC9BW,KAAK,CAAC,YAAY;MACpB;IACF,CAAC;IAED;IACA4D,UAAUA,CAAA,EAAG;MACX,OAAO,IAAI,CAAC9F,KAAK,CAACC,SAAS,CAACC,SAAQ;IACtC,CAAC;IAED;IACA6F,UAAUA,CAACtF,OAAO,EAAE;MAClB,IAAI,CAACT,KAAK,CAACC,SAAS,CAACC,SAAQ,GAAIO,OAAM;MACvC,IAAI,CAACC,KAAK,CAAC,mBAAmB,EAAED,OAAO;IACzC,CAAC;IAED;IACAuF,KAAKA,CAAA,EAAG;MACN,IAAI,CAAChG,KAAK,CAACC,SAAS,CAACC,SAAQ,GAAI,EAAC;MAClC,IAAI,CAACQ,KAAK,CAAC,mBAAmB,EAAE,EAAE;IACpC;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
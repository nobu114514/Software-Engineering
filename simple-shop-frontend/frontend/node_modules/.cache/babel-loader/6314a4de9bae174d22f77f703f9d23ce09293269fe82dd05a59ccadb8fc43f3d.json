{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nexport default {\n  name: 'ProductBatchForm',\n  components: {},\n  data() {\n    return {\n      products: [{\n        name: '',\n        categoryId: null,\n        subCategory: null,\n        price: 0,\n        theme: '',\n        description: ''\n      }, {\n        name: '',\n        categoryId: 'same',\n        subCategory: 'same',\n        price: 0,\n        theme: '',\n        description: ''\n      }],\n      loading: true,\n      error: '',\n      success: false,\n      categories: [],\n      subCategoriesMap: {}\n    };\n  },\n  created() {\n    this.fetchCategories();\n  },\n  methods: {\n    async fetchCategories() {\n      try {\n        const response = await this.$axios.get('http://localhost:8081/api/categories/active');\n        this.categories = response.data.data || [];\n        // 如果有分类，自动选择第一个分类作为默认值\n        if (this.categories.length > 0 && this.products[0].categoryId === null) {\n          this.products[0].categoryId = this.categories[0].id;\n          this.loadSubCategories(this.categories[0].id, 0);\n        }\n        this.loading = false;\n      } catch (err) {\n        this.error = '获取分类信息失败';\n        this.loading = false;\n        console.error(err);\n      }\n    },\n    async loadSubCategories(categoryId, index) {\n      if (!categoryId || categoryId === 'same') {\n        this.products[index].subCategory = index > 0 ? 'same' : null;\n        return;\n      }\n      try {\n        // 如果已经加载过该分类的子分类，则直接使用\n        if (!this.subCategoriesMap[categoryId]) {\n          const response = await this.$axios.get(`http://localhost:8081/api/sub-categories/category/${categoryId}`);\n          this.subCategoriesMap[categoryId] = Array.isArray(response.data) ? response.data : [];\n        }\n\n        // 如果有子分类，自动选择第一个子分类\n        if (this.subCategoriesMap[categoryId].length > 0) {\n          this.products[index].subCategory = this.subCategoriesMap[categoryId][0];\n        } else {\n          this.products[index].subCategory = null;\n        }\n      } catch (err) {\n        console.error('获取子分类信息失败', err);\n      }\n    },\n    onCategoryChange(index) {\n      this.loadSubCategories(this.products[index].categoryId, index);\n\n      // 处理当前行的二级分类：如果一级分类为\"同上\"或与上一行相同，可以选择\"同上\"\n      const currentItem = this.products[index];\n      if (currentItem.categoryId === 'same' || this.hasSameCategoryAsPrevious(index)) {\n        // 可以设置为\"同上\"\n        currentItem.subCategory = 'same';\n      } else {\n        // 否则需要选择一个实际的子分类\n        const actualCategoryId = this.getActualCategoryId(index);\n        if (actualCategoryId && this.subCategoriesMap[actualCategoryId] && this.subCategoriesMap[actualCategoryId].length > 0) {\n          currentItem.subCategory = this.subCategoriesMap[actualCategoryId][0];\n        } else {\n          currentItem.subCategory = null;\n        }\n      }\n\n      // 更新当前行之后的所有行的子分类\n      for (let i = index + 1; i < this.products.length; i++) {\n        if (this.products[i].categoryId === 'same') {\n          // 对于选择\"同上\"的行，可以直接设置子分类为\"同上\"\n          this.products[i].subCategory = 'same';\n        }\n      }\n    },\n    getSubCategories(index) {\n      const categoryId = this.products[index].categoryId;\n      if (categoryId === 'same') {\n        // 向上查找第一个非'same'的分类ID\n        for (let i = index - 1; i >= 0; i--) {\n          if (this.products[i].categoryId && this.products[i].categoryId !== 'same') {\n            return this.subCategoriesMap[this.products[i].categoryId] || [];\n          }\n        }\n      }\n      return categoryId && categoryId !== 'same' ? this.subCategoriesMap[categoryId] || [] : [];\n    },\n    // 获取实际的分类ID（处理'same'逻辑）\n    getActualCategoryId(index) {\n      if (this.products[index].categoryId === 'same') {\n        // 向上查找第一个有效的分类ID\n        for (let i = index - 1; i >= 0; i--) {\n          if (this.products[i].categoryId && this.products[i].categoryId !== 'same') {\n            return this.products[i].categoryId;\n          }\n        }\n      }\n      return this.products[index].categoryId;\n    },\n    // 获取实际的子分类（处理'same'逻辑）\n    getActualSubCategory(index) {\n      if (this.products[index].subCategory === 'same') {\n        // 向上查找第一个有效的子分类\n        for (let i = index - 1; i >= 0; i--) {\n          if (this.products[i].subCategory && this.products[i].subCategory !== 'same') {\n            return this.products[i].subCategory;\n          }\n        }\n      }\n      return this.products[index].subCategory;\n    },\n    // 检查当前行的一级分类是否与上一行相同\n    hasSameCategoryAsPrevious(index) {\n      if (index <= 0) return false;\n      const currentCategoryId = this.getActualCategoryId(index);\n      const prevCategoryId = this.getActualCategoryId(index - 1);\n      return currentCategoryId === prevCategoryId;\n    },\n    addRow() {\n      // 创建新行，默认选择\"同上\"\n      const newRow = {\n        name: '',\n        categoryId: 'same',\n        subCategory: 'same',\n        // 因为一级分类是\"同上\"，所以二级分类也可以默认为\"同上\"\n        price: 0,\n        theme: '',\n        description: ''\n      };\n\n      // 在末尾添加新行\n      this.products.push(newRow);\n    },\n    removeRow(index) {\n      if (this.products.length > 1) {\n        // 保存被删除行的实际分类信息\n        const deletedCategoryId = this.getActualCategoryId(index);\n        const deletedSubCategory = this.getActualSubCategory(index);\n\n        // 删除该行\n        this.products.splice(index, 1);\n\n        // 只检查并更新删除行的下一个商品（如果该商品的一二级分类是\"同上\"）\n        const nextIndex = index; // 删除后，下一个商品的索引就是原来的删除位置\n        if (nextIndex < this.products.length) {\n          const nextProduct = this.products[nextIndex];\n          // 只有当下一个商品的分类或子分类是\"同上\"时，才需要更新\n          if (nextProduct.categoryId === 'same' || nextProduct.subCategory === 'same') {\n            // 使用被删除行的实际分类信息\n            if (nextProduct.categoryId === 'same' && deletedCategoryId) {\n              nextProduct.categoryId = deletedCategoryId;\n            }\n            if (nextProduct.subCategory === 'same' && deletedSubCategory) {\n              nextProduct.subCategory = deletedSubCategory;\n            }\n          }\n        }\n      }\n    },\n    async batchPublish() {\n      // 验证所有必填字段\n      for (let i = 0; i < this.products.length; i++) {\n        const product = this.products[i];\n        if (!product.name || !this.getActualCategoryId(i) || !this.getActualSubCategory(i) || !product.price) {\n          this.error = `第 ${i + 1} 行商品信息不完整，请检查`;\n          return;\n        }\n      }\n      this.error = '';\n      this.loading = true;\n      try {\n        // 逐个发布商品\n        const publishPromises = this.products.map((product, index) => {\n          // 构建商品对象，使用实际的子分类\n          const actualSubCategory = this.getActualSubCategory(index);\n          const productData = {\n            name: product.name,\n            subCategory: actualSubCategory,\n            price: product.price,\n            description: product.description,\n            theme: product.theme\n          };\n          return this.$axios.post('http://localhost:8081/api/products', productData);\n        });\n        await Promise.all(publishPromises);\n        this.success = true;\n\n        // 发布成功后重置表单\n        setTimeout(() => {\n          this.$router.push('/seller/dashboard');\n        }, 1500);\n      } catch (err) {\n        this.error = '批量发布失败，请重试';\n        console.error(err);\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","components","data","products","categoryId","subCategory","price","theme","description","loading","error","success","categories","subCategoriesMap","created","fetchCategories","methods","response","$axios","get","length","id","loadSubCategories","err","console","index","Array","isArray","onCategoryChange","currentItem","hasSameCategoryAsPrevious","actualCategoryId","getActualCategoryId","i","getSubCategories","getActualSubCategory","currentCategoryId","prevCategoryId","addRow","newRow","push","removeRow","deletedCategoryId","deletedSubCategory","splice","nextIndex","nextProduct","batchPublish","product","publishPromises","map","actualSubCategory","productData","post","Promise","all","setTimeout","$router"],"sources":["F:\\作业\\Software-Engineering2.0\\litemall\\simple-shop-frontend\\frontend\\src\\views\\ProductBatchForm.vue"],"sourcesContent":["<template>\n  <div class=\"product-batch-form\">\n    <h1>批量发布商品</h1>\n    \n    <div v-if=\"loading\" class=\"loading\">加载中...</div>\n    \n    <div v-if=\"error\" class=\"alert alert-danger\">\n      {{ error }}\n    </div>\n    \n    <div v-if=\"success\" class=\"alert alert-success\">\n      商品批量发布成功！\n    </div>\n    \n    <div v-if=\"!loading\" class=\"card\">\n      <div class=\"table-responsive\">\n        <table class=\"batch-table\">\n          <thead>\n            <tr>\n              <th style=\"width: 5%\">序号</th>\n              <th style=\"width: 15%\">商品名称</th>\n              <th style=\"width: 15%\">商品分类</th>\n              <th style=\"width: 15%\">商品子分类</th>\n              <th style=\"width: 10%\">商品价格</th>\n              <th style=\"width: 10%\">商品主题</th>\n              <th style=\"width: 24%\">商品详情</th>\n              <th style=\"width: 6%\">操作</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(item, index) in products\" :key=\"index\">\n              <td>{{ index + 1 }}</td>\n              <td>\n                <input type=\"text\" v-model=\"item.name\" required placeholder=\"请输入商品名称\">\n              </td>\n              <td>\n                <select v-model=\"item.categoryId\" @change=\"onCategoryChange(index)\" required>\n                  <option v-if=\"index > 0\" :value=\"'same'\">同上</option>\n                  <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\n                    {{ category.name }}\n                  </option>\n                </select>\n              </td>\n              <td>\n                <select v-model=\"item.subCategory\" required>\n                  <!-- 当一级分类不为\"同上\"且与上一个一级分类相同时，才显示二级分类的\"同上\"选项 -->\n                  <!-- 换句话说：如果一级分类为\"同上\"或与上一个一级分类相同，才显示\"同上\"选项 -->\n                  <option v-if=\"index > 0 && (item.categoryId === 'same' || hasSameCategoryAsPrevious(index))\" :value=\"'same'\">同上</option>\n                  <option v-for=\"subCategory in getSubCategories(index)\" :key=\"subCategory.id\" :value=\"subCategory\">\n                    {{ subCategory.name }}\n                  </option>\n                </select>\n              </td>\n              <td>\n                <input type=\"number\" v-model=\"item.price\" min=\"0\" step=\"0.01\" required placeholder=\"0.00\">\n              </td>\n              <td>\n                <input type=\"text\" v-model=\"item.theme\" placeholder=\"非必填\">\n              </td>\n              <td>\n                <textarea v-model=\"item.description\" placeholder=\"请输入商品详情\"></textarea>\n              </td>\n              <td>\n                <button @click=\"removeRow(index)\" class=\"btn-circle remove-btn\" title=\"删除一行\" :disabled=\"products.length <= 1\">-</button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      \n      <div class=\"add-button-container\">\n        <button @click=\"addRow\" class=\"btn-circle add-btn\" title=\"添加一行\">+</button>\n      </div>\n      \n      <div class=\"form-actions\">\n        <button @click=\"batchPublish\" class=\"btn btn-primary\">批量发布</button>\n        <a href=\"/seller/product/new\" class=\"btn btn-secondary\">返回</a>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ProductBatchForm',\n  components: {\n  },\n  data() {\n      return {\n        products: [\n          {\n            name: '',\n            categoryId: null,\n            subCategory: null,\n            price: 0,\n            theme: '',\n            description: ''\n          },\n          {\n            name: '',\n            categoryId: 'same',\n            subCategory: 'same',\n            price: 0,\n            theme: '',\n            description: ''\n          }\n        ],\n        loading: true,\n        error: '',\n        success: false,\n        categories: [],\n        subCategoriesMap: {}\n      }\n    },\n  created() {\n    this.fetchCategories()\n  },\n  methods: {\n    async fetchCategories() {\n      try {\n        const response = await this.$axios.get('http://localhost:8081/api/categories/active')\n        this.categories = response.data.data || []\n        // 如果有分类，自动选择第一个分类作为默认值\n        if (this.categories.length > 0 && this.products[0].categoryId === null) {\n          this.products[0].categoryId = this.categories[0].id\n          this.loadSubCategories(this.categories[0].id, 0)\n        }\n        this.loading = false\n      } catch (err) {\n        this.error = '获取分类信息失败'\n        this.loading = false\n        console.error(err)\n      }\n    },\n    \n    async loadSubCategories(categoryId, index) {\n      if (!categoryId || categoryId === 'same') {\n        this.products[index].subCategory = index > 0 ? 'same' : null\n        return\n      }\n      \n      try {\n        // 如果已经加载过该分类的子分类，则直接使用\n        if (!this.subCategoriesMap[categoryId]) {\n          const response = await this.$axios.get(`http://localhost:8081/api/sub-categories/category/${categoryId}`)\n          this.subCategoriesMap[categoryId] = Array.isArray(response.data) ? response.data : []\n        }\n        \n        // 如果有子分类，自动选择第一个子分类\n        if (this.subCategoriesMap[categoryId].length > 0) {\n          this.products[index].subCategory = this.subCategoriesMap[categoryId][0]\n        } else {\n          this.products[index].subCategory = null\n        }\n      } catch (err) {\n        console.error('获取子分类信息失败', err)\n      }\n    },\n    \n    onCategoryChange(index) {\n      this.loadSubCategories(this.products[index].categoryId, index)\n      \n      // 处理当前行的二级分类：如果一级分类为\"同上\"或与上一行相同，可以选择\"同上\"\n      const currentItem = this.products[index]\n      if (currentItem.categoryId === 'same' || this.hasSameCategoryAsPrevious(index)) {\n        // 可以设置为\"同上\"\n        currentItem.subCategory = 'same'\n      } else {\n        // 否则需要选择一个实际的子分类\n        const actualCategoryId = this.getActualCategoryId(index)\n        if (actualCategoryId && this.subCategoriesMap[actualCategoryId] && this.subCategoriesMap[actualCategoryId].length > 0) {\n          currentItem.subCategory = this.subCategoriesMap[actualCategoryId][0]\n        } else {\n          currentItem.subCategory = null\n        }\n      }\n      \n      // 更新当前行之后的所有行的子分类\n      for (let i = index + 1; i < this.products.length; i++) {\n        if (this.products[i].categoryId === 'same') {\n          // 对于选择\"同上\"的行，可以直接设置子分类为\"同上\"\n          this.products[i].subCategory = 'same'\n        }\n      }\n    },\n    \n    getSubCategories(index) {\n      const categoryId = this.products[index].categoryId\n      if (categoryId === 'same') {\n        // 向上查找第一个非'same'的分类ID\n        for (let i = index - 1; i >= 0; i--) {\n          if (this.products[i].categoryId && this.products[i].categoryId !== 'same') {\n            return this.subCategoriesMap[this.products[i].categoryId] || []\n          }\n        }\n      }\n      return categoryId && categoryId !== 'same' ? this.subCategoriesMap[categoryId] || [] : []\n    },\n    \n    // 获取实际的分类ID（处理'same'逻辑）\n    getActualCategoryId(index) {\n      if (this.products[index].categoryId === 'same') {\n        // 向上查找第一个有效的分类ID\n        for (let i = index - 1; i >= 0; i--) {\n          if (this.products[i].categoryId && this.products[i].categoryId !== 'same') {\n            return this.products[i].categoryId\n          }\n        }\n      }\n      return this.products[index].categoryId\n    },\n    \n    // 获取实际的子分类（处理'same'逻辑）\n    getActualSubCategory(index) {\n      if (this.products[index].subCategory === 'same') {\n        // 向上查找第一个有效的子分类\n        for (let i = index - 1; i >= 0; i--) {\n          if (this.products[i].subCategory && this.products[i].subCategory !== 'same') {\n            return this.products[i].subCategory\n          }\n        }\n      }\n      return this.products[index].subCategory\n    },\n    \n    // 检查当前行的一级分类是否与上一行相同\n    hasSameCategoryAsPrevious(index) {\n      if (index <= 0) return false;\n      \n      const currentCategoryId = this.getActualCategoryId(index);\n      const prevCategoryId = this.getActualCategoryId(index - 1);\n      \n      return currentCategoryId === prevCategoryId;\n    },\n    \n    addRow() {\n      // 创建新行，默认选择\"同上\"\n      const newRow = {\n        name: '',\n        categoryId: 'same',\n        subCategory: 'same', // 因为一级分类是\"同上\"，所以二级分类也可以默认为\"同上\"\n        price: 0,\n        theme: '',\n        description: ''\n      }\n      \n      // 在末尾添加新行\n      this.products.push(newRow)\n    },\n    \n    removeRow(index) {\n      if (this.products.length > 1) {\n        // 保存被删除行的实际分类信息\n        const deletedCategoryId = this.getActualCategoryId(index)\n        const deletedSubCategory = this.getActualSubCategory(index)\n        \n        // 删除该行\n        this.products.splice(index, 1)\n        \n        // 只检查并更新删除行的下一个商品（如果该商品的一二级分类是\"同上\"）\n        const nextIndex = index // 删除后，下一个商品的索引就是原来的删除位置\n        if (nextIndex < this.products.length) {\n          const nextProduct = this.products[nextIndex]\n          // 只有当下一个商品的分类或子分类是\"同上\"时，才需要更新\n          if (nextProduct.categoryId === 'same' || nextProduct.subCategory === 'same') {\n            // 使用被删除行的实际分类信息\n            if (nextProduct.categoryId === 'same' && deletedCategoryId) {\n              nextProduct.categoryId = deletedCategoryId\n            }\n            if (nextProduct.subCategory === 'same' && deletedSubCategory) {\n              nextProduct.subCategory = deletedSubCategory\n            }\n          }\n        }\n      }\n    },\n    \n    async batchPublish() {\n      // 验证所有必填字段\n      for (let i = 0; i < this.products.length; i++) {\n        const product = this.products[i]\n        if (!product.name || !this.getActualCategoryId(i) || !this.getActualSubCategory(i) || !product.price) {\n          this.error = `第 ${i + 1} 行商品信息不完整，请检查`\n          return\n        }\n      }\n      \n      this.error = ''\n      this.loading = true\n      \n      try {\n        // 逐个发布商品\n        const publishPromises = this.products.map((product, index) => {\n          // 构建商品对象，使用实际的子分类\n          const actualSubCategory = this.getActualSubCategory(index)\n          const productData = {\n            name: product.name,\n            subCategory: actualSubCategory,\n            price: product.price,\n            description: product.description,\n            theme: product.theme\n          }\n          return this.$axios.post('http://localhost:8081/api/products', productData)\n        })\n        \n        await Promise.all(publishPromises)\n        this.success = true\n        \n        // 发布成功后重置表单\n        setTimeout(() => {\n          this.$router.push('/seller/dashboard')\n        }, 1500)\n      } catch (err) {\n        this.error = '批量发布失败，请重试'\n        console.error(err)\n      } finally {\n        this.loading = false\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.product-batch-form {\n  max-width: 100%;\n  margin: 0 auto;\n}\n\n.table-responsive {\n  overflow-x: auto;\n  margin-bottom: 1.5rem;\n}\n\n.batch-table {\n  width: 100%;\n  border-collapse: collapse;\n}\n\n.batch-table th,\n.batch-table td {\n  padding: 0.75rem;\n  text-align: left;\n  border-bottom: 1px solid #ddd;\n}\n\n.batch-table th {\n  background-color: #f5f5f5;\n  font-weight: 600;\n}\n\n.batch-table input,\n.batch-table select,\n.batch-table textarea {\n  width: 100%;\n  padding: 0.5rem;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 0.875rem;\n}\n\n.batch-table textarea {\n  min-height: 60px;\n  resize: vertical;\n}\n\n.add-button-container {\n  display: flex;\n  justify-content: flex-start;\n  margin-top: 1rem;\n}\n\n.action-buttons {\n  display: flex;\n  align-items: center;\n}\n\n.btn-circle {\n  width: 30px;\n  height: 30px;\n  border-radius: 50%;\n  border: none;\n  color: white;\n  font-size: 18px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.3s ease;\n}\n\n.add-btn {\n  background-color: #4CAF50;\n}\n\n.add-btn:hover {\n  background-color: #45a049;\n}\n\n.remove-btn {\n  background-color: #f44336;\n}\n\n.remove-btn:hover {\n  background-color: #da190b;\n}\n\n.remove-btn:disabled {\n  background-color: #cccccc;\n  cursor: not-allowed;\n}\n\n.form-actions {\n  display: flex;\n  gap: 1rem;\n  justify-content: flex-end;\n  margin-top: 1.5rem;\n}\n\n.loading {\n  text-align: center;\n  padding: 2rem;\n  font-size: 1.2rem;\n}\n\n.alert {\n  padding: 1rem;\n  margin-bottom: 1.5rem;\n  border-radius: 4px;\n}\n\n.alert-danger {\n  background-color: #f8d7da;\n  color: #721c24;\n  border: 1px solid #f5c6cb;\n}\n\n.alert-success {\n  background-color: #d4edda;\n  color: #155724;\n  border: 1px solid #c3e6cb;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n  .table-controls {\n    flex-direction: column;\n  }\n  \n  .form-actions {\n    flex-direction: column;\n  }\n  \n  .batch-table {\n    font-size: 0.875rem;\n  }\n  \n  .batch-table th,\n  .batch-table td {\n    padding: 0.5rem;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}